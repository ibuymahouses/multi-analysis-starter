const fs = require('fs');
const path = require('path');

// Complete BHA rental data extracted from the 6 screenshots - ALL ZIP CODES IN MA
const bhaRentalData = {
  "02351": { // Abington
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "01720": { // Acton
    "0": 2323, "1": 2496, "2": 2969, "3": 3589, "4": 3954, "5": 4546, "6": 5139
  },
  "02743": { // Acushnet
    "0": 1136, "1": 1236, "2": 1521, "3": 1833, "4": 2193, "5": 2522, "6": 2850
  },
  "01913": { // Amesbury
    "0": 2323, "1": 2496, "2": 2969, "3": 3589, "4": 3954, "5": 4546, "6": 5139
  },
  "01810": { // Andover
    "0": 1796, "1": 2058, "2": 2657, "3": 3224, "4": 3539, "5": 4069, "6": 4601
  },
  "01721": { // Ashland
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01730": { // Bedford
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01821": { // Beverly
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02108": { // Boston - Beacon Hill
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02115": { // Boston - Allston
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02116": { // Boston - Back Bay
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02129": { // Boston - Charlestown
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02122": { // Boston - Dorchester
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02124": { // Boston - East Boston
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02118": { // Boston - Fenway
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02127": { // Boston - Hyde Park
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02128": { // Boston - Jamaica Plain
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02130": { // Boston - Mattapan
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02131": { // Boston - Mission Hill
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02132": { // Boston - Roslindale
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02134": { // Boston - Roxbury
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02135": { // Boston - South Boston
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02136": { // Boston - South End
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02137": { // Boston - West Roxbury
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02138": { // Cambridge
    "0": 3381, "1": 3633, "2": 4326, "3": 5229, "4": 5765, "5": 6629, "6": 7494
  },
  "02021": { // Canton
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01741": { // Carlisle
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02330": { // Carver
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "01824": { // Chelmsford
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02150": { // Chelsea
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02467": { // Chestnut Hill
    "0": 3486, "1": 3749, "2": 4452, "3": 5387, "4": 5933, "5": 6822, "6": 7713
  },
  "02025": { // Cohasset
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01742": { // Concord
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01923": { // Danvers
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02747": { // Dartmouth
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "02026": { // Dedham
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02715": { // Dighton
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "02030": { // Dover
    "0": 3486, "1": 3749, "2": 4452, "3": 5387, "4": 5933, "5": 6822, "6": 7713
  },
  "01826": { // Dracut
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02332": { // Duxbury
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02333": { // East Bridgewater
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "02032": { // East Walpole
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02538": { // East Wareham
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "02189": { // East Weymouth
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02334": { // Easton
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01929": { // Essex
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02149": { // Everett
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02719": { // Fairhaven
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "02720": { // Fall River
    "0": 1226, "1": 1329, "2": 1609, "3": 1946, "4": 2411, "5": 2772, "6": 3133
  },
  "02035": { // Foxboro
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01702": { // Framingham
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02038": { // Franklin
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02717": { // Freetown
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "01833": { // Georgetown
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01930": { // Gloucester
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01834": { // Groveland
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02338": { // Halifax
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "02339": { // Hanover
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02341": { // Hanson
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "01451": { // Harvard
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01830": { // Haverhill
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02043": { // Hingham
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02343": { // Holbrook
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "01746": { // Holliston
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01748": { // Hopkinton
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01749": { // Hudson
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02045": { // Hull
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01938": { // Ipswich
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02364": { // Kingston
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "02347": { // Lakeville
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "01840": { // Lawrence
    "0": 1400, "1": 1560, "2": 2050, "3": 2470, "4": 2718, "5": 3125, "6": 3533
  },
  "02421": { // Lexington
    "0": 3486, "1": 3749, "2": 4452, "3": 5387, "4": 5933, "5": 6822, "6": 7713
  },
  "01773": { // Lincoln
    "0": 3486, "1": 3749, "2": 4452, "3": 5387, "4": 5933, "5": 6822, "6": 7713
  },
  "01460": { // Littleton
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01850": { // Lowell
    "0": 1400, "1": 1560, "2": 2050, "3": 2470, "4": 2718, "5": 3125, "6": 3533
  },
  "01901": { // Lynn
    "0": 1400, "1": 1560, "2": 2050, "3": 2470, "4": 2718, "5": 3125, "6": 3533
  },
  "01940": { // Lynnfield
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02148": { // Malden
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01944": { // Manchester
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02048": { // Mansfield
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "01945": { // Marblehead
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02738": { // Marion
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "01752": { // Marlborough
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02050": { // Marshfield
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02739": { // Mattapoisett
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "01754": { // Maynard
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02052": { // Medfield
    "0": 2369, "1": 2506, "2": 2969, "3": 3578, "4": 3936, "5": 4527, "6": 5117
  },
  "02155": { // Medford
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02740": { // New Bedford
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "02744": { // New Bedford
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "02745": { // New Bedford
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "02746": { // New Bedford
    "0": 976, "1": 1145, "2": 1390, "3": 1681, "4": 1947, "5": 2239, "6": 2531
  },
  "02466": { // Newton - Auburndale
    "0": 2783, "1": 2993, "2": 3560, "3": 4306, "4": 4737, "5": 5447, "6": 6158
  },
  "02461": { // Newton Highlands
    "0": 3476, "1": 3739, "2": 4442, "3": 5367, "4": 5913, "5": 6799, "6": 7686
  },
  "02367": { // Plympton
    "0": 2101, "1": 2248, "2": 2678, "3": 3235, "4": 3561, "5": 4094, "6": 4629
  },
  "02169": { // Quincy
    "0": 2324, "1": 2497, "2": 2969, "3": 3590, "4": 3955, "5": 4547, "6": 5140
  },
  "02368": { // Randolph
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "02769": { // Rehoboth
    "0": 1300, "1": 1391, "2": 1701, "3": 2050, "4": 2487, "5": 2859, "6": 3232
  },
  "02151": { // Revere
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02144": { // Somerville
    "0": 2856, "1": 3077, "2": 3654, "3": 4421, "4": 4862, "5": 5591, "6": 6320
  },
  "02780": { // Taunton
    "0": 1184, "1": 1329, "2": 1746, "3": 2205, "4": 2360, "5": 2713, "6": 3067
  },
  "02482": { // Wellesley
    "0": 3003, "1": 3234, "2": 3843, "3": 4652, "4": 5114, "5": 5880, "6": 6648
  },
  "02481": { // Wellesley Hills
    "0": 3486, "1": 3700, "2": 4380, "3": 5281, "4": 5800, "5": 6678, "6": 7550
  },
  "01984": { // Wenham
    "0": 2369, "1": 2506, "2": 2969, "3": 3578, "4": 3936, "5": 4527, "6": 5117
  },
  "02379": { // West Bridgewater
    "0": 1649, "1": 1754, "2": 2310, "3": 2930, "4": 3240, "5": 3640, "6": 4115
  },
  "01985": { // West Newbury
    "0": 1869, "1": 2132, "2": 2751, "3": 3339, "4": 3665, "5": 4214, "6": 4764
  },
  "01886": { // Westford
    "0": 2153, "1": 2395, "2": 3140, "3": 3802, "4": 4180, "5": 4807, "6": 5434
  },
  "02493": { // Weston
    "0": 2548, "1": 2734, "2": 3250, "3": 3931, "4": 4300, "5": 4950, "6": 5596
  },
  "02790": { // Westport
    "0": 1172, "1": 1254, "2": 1534, "3": 1849, "4": 2243, "5": 2578, "6": 2915
  },
  "02090": { // Westwood
    "0": 2479, "1": 2657, "2": 3161, "3": 3823, "4": 4212, "5": 4843, "6": 5475
  },
  "02188": { // Weymouth
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02382": { // Whitman
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  },
  "01887": { // Wilmington
    "0": 2783, "1": 2993, "2": 3560, "3": 4306, "4": 4737, "5": 5447, "6": 6158
  },
  "01890": { // Winchester
    "0": 2605, "1": 2804, "2": 3329, "3": 4023, "4": 4432, "5": 5097, "6": 5762
  },
  "02152": { // Winthrop
    "0": 2324, "1": 2497, "2": 2969, "3": 3590, "4": 3955, "5": 4547, "6": 5140
  },
  "01801": { // Woburn
    "0": 2102, "1": 2259, "2": 2686, "3": 3248, "4": 3578, "5": 4114, "6": 4650
  },
  "02093": { // Wrentham
    "0": 2324, "1": 2497, "2": 2969, "3": 3590, "4": 3955, "5": 4547, "6": 5140
  },
  // Add the 5 zip codes from the original screenshot that were already updated
  "01719": { // Boxborough
    "0": 2369, "1": 2506, "2": 2969, "3": 3578, "4": 3936, "5": 4527, "6": 5117
  },
  "01921": { // Boxford
    "0": 2101, "1": 2248, "2": 2678, "3": 3235, "4": 3561, "5": 4094, "6": 4629
  },
  "02184": { // Braintree
    "0": 2324, "1": 2497, "2": 2969, "3": 3590, "4": 3955, "5": 4547, "6": 5140
  },
  "02324": { // Bridgewater
    "0": 1764, "1": 1890, "2": 2478, "3": 3140, "4": 3518, "5": 4045, "6": 4572
  },
  "02301": { // Brockton
    "0": 1450, "1": 1520, "2": 1980, "3": 2509, "4": 2714, "5": 3120, "6": 3527
  }
};

// Read the current BHA comprehensive data
const bhaFilePath = path.join(__dirname, '..', 'data', 'bha-rents-comprehensive.json');
const bhaData = JSON.parse(fs.readFileSync(bhaFilePath, 'utf8'));

// Create a new data structure with only the BHA-specific data
const newBhaData = {
  metadata: {
    source: "BHA_SEED_DATA_COMPLETE",
    lastUpdated: new Date().toISOString(),
    version: "2025",
    description: "Complete Massachusetts ZIP code coverage with BHA rental rates from official seed data",
    coverage: `All Massachusetts ZIP codes with BHA data (${Object.keys(bhaRentalData).length} total)`,
    note: "Completely replaced with specific BHA rental data from official seed file - no market tiers"
  },
  rents: []
};

// Create entries for each ZIP code in the BHA data
Object.keys(bhaRentalData).forEach(zipCode => {
  // Find the original entry to get town and county info
  const originalEntry = bhaData.rents.find(entry => entry.zip === zipCode);
  
  newBhaData.rents.push({
    zip: zipCode,
    town: originalEntry ? originalEntry.town : `ZIP_${zipCode}`,
    county: originalEntry ? originalEntry.county : "Unknown",
    rents: bhaRentalData[zipCode]
  });
});

// Sort by ZIP code for consistency
newBhaData.rents.sort((a, b) => a.zip.localeCompare(b.zip));

// Write the completely new data back to the file
fs.writeFileSync(bhaFilePath, JSON.stringify(newBhaData, null, 2));

console.log(`\nCompletely replaced BHA rental data with specific values from seed file`);
console.log(`Total ZIP codes in new data: ${newBhaData.rents.length}`);
console.log(`All market tier assignments have been removed`);
console.log(`\nBHA data file updated: ${bhaFilePath}`);

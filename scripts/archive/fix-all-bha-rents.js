const fs = require('fs');
const path = require('path');

// Parse the space-delimited rental data
const rentalDataString = `Abington 02351 $1,450 $1,520 $1,980 $2,509 $2,714 $3,120 $3,527 Acton 01720 $2,323 $2,496 $2,969 $3,589 $3,954 $4,546 $5,139 Acushnet 02743 $1,136 $1,236 $1,521 $1,833 $2,193 $2,522 $2,850 Amesbury 01913 $2,323 $2,496 $2,969 $3,589 $3,954 $4,546 $5,139 Andover 01810 $1,796 $2,058 $2,657 $3,224 $3,539 $4,069 $4,601 Arlington 02474 $2,468 $2,646 $3,150 $3,812 $4,200 $4,830 $5,460 Arlington 02476 $2,323 $2,496 $2,969 $3,589 $3,954 $4,546 $5,139 Ashland 01721 $2,375 $2,552 $3,035 $3,669 $4,042 $4,647 $5,254 Attleboro 02703 $1,502 $1,610 $1,974 $2,384 $2,870 $3,406 $3,750 Avon 02322 $1,461 $1,561 $2,050 $2,600 $2,913 $3,350 $3,787 Ayer 01432 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Bedford 01730 $2,646 $2,846 $3,381 $4,085 $4,505 $5,180 $5,856 Bellingham 02019 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Belmont 02478 $2,699 $2,909 $3,455 $4,180 $4,600 $5,290 $5,980 Berkley 02779 $1,418 $1,569 $2,058 $2,607 $2,729 $3,138 $3,548 Beverly 01915 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Billerica 01821 $1,400 $1,560 $2,020 $2,434 $2,678 $3,079 $3,481 Bolton 01740 $1,649 $1,796 $2,268 $2,993 $3,381 $3,889 $4,396 Boston 02109 $3,486 $3,749 $4,452 $5,387 $5,933 $6,822 $7,713 Boston - Allston 02134 $2,426 $2,607 $3,100 $3,749 $4,129 $4,748 $5,367 Boston - Back Bay 02116 $3,455 $3,718 $4,421 $5,346 $5,892 $6,775 $7,659 Boston - Beacon Hill 02108 $3,266 $3,450 $4,100 $4,950 $5,450 $6,250 $7,000 Boston - Brighton 02135 $2,560 $2,750 $3,270 $3,950 $4,350 $5,002 $5,655 Boston - Charlestown 02129 $2,920 $3,140 $3,730 $4,510 $4,970 $5,715 $6,461 Boston - Chinatown 02111 $3,030 $3,250 $3,870 $4,680 $5,150 $5,922 $6,695 Boston - Dorchester 02122 $2,212 $2,377 $2,827 $3,418 $3,765 $4,329 $4,894 Boston - Dorchester 02124 $2,212 $2,377 $2,827 $3,418 $3,765 $4,329 $4,894 Boston - Dorchester 02125 $2,212 $2,377 $2,827 $3,418 $3,765 $4,329 $4,894 Boston - Dorchester / Roxbury 02121 $2,212 $2,377 $2,827 $3,418 $3,765 $4,329 $4,894 Boston - Downtown 02199 $3,486 $3,749 $4,452 $5,387 $5,933 $6,822 $7,713 Boston - East Boston 02128 $2,212 $2,377 $2,827 $3,418 $3,765 $4,329 $4,894 Boston - Fenway 02115 $2,426 $2,607 $3,100 $3,749 $4,129 $4,748 $5,367 Boston - Financial Disctrict 02110 $3,486 $3,749 $4,452 $5,387 $5,933 $6,822 $7,713 Boston - Harvard Business 02163 $3,210 $3,450 $4,130 $4,960 $5,460 $6,279 $7,098 Boston - Hyde Park 02136 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Boston - Jamaica Plain 02130 $2,500 $2,680 $3,190 $3,860 $4,250 $4,887 $5,525 Boston - Kenmore 02215 $2,950 $3,170 $3,770 $4,560 $5,020 $5,773 $6,526 Boston - Mattapan 02126 $2,212 $2,377 $2,827 $3,418 $3,765 $4,329 $4,894 Boston - North End 02113 $2,836 $3,046 $3,623 $4,380 $4,821 $5,543 $6,267 Boston - Roslindale 02131 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Boston - Roxbury 02119 $2,212 $2,377 $2,827 $3,418 $3,765 $4,329 $4,894 Boston - Roxbury 02120 $2,230 $2,397 $2,850 $3,446 $3,796 $4,365 $4,934 Boston - Seaport 02210 $3,320 $3,570 $4,240 $5,130 $5,650 $6,497 $7,345 Boston - South Boston 02127 $2,794 $3,003 $3,575 $4,323 $4,763 $5,477 $6,192 Boston - South End / Roxbury 02118 $2,309 $2,481 $2,950 $3,600 $3,950 $4,518 $5,107 Boston - West End 02114 $3,320 $3,570 $4,240 $5,130 $5,650 $6,497 $7,345 Boston - West Roxbury 02132 $2,326 $2,499 $2,972 $3,594 $3,959 $4,552 $5,146 Boxborough 01719 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Boxford 01921 $2,101 $2,248 $2,678 $3,235 $3,561 $4,094 $4,629 Braintree 02184 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Bridgewater 02324 $1,764 $1,890 $2,478 $3,140 $3,518 $4,045 $4,573 Brockton 02301 $1,450 $1,520 $1,980 $2,509 $2,714 $3,120 $3,527 Brockton 02302 $1,461 $1,561 $2,050 $2,600 $2,913 $3,350 $3,787 Brookline 02445 $3,234 $3,476 $4,137 $4,998 $5,513 $6,339 $7,167 Brookline 02446 $3,455 $3,707 $4,410 $5,334 $5,870 $6,750 $7,631 Burlington 01803 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Buzzards Bay 02532 $1,624 $1,732 $2,275 $2,777 $3,166 $3,640 $4,116 Cambridge 02138 $3,381 $3,633 $4,326 $5,229 $5,765 $6,629 $7,494 Cambridge 02139 $3,298 $3,539 $4,211 $5,094 $5,608 $6,449 $7,290 Cambridge 02140 $2,993 $3,213 $3,822 $4,625 $5,100 $5,875 $6,621 Cambridge 02141 $2,930 $3,151 $3,749 $4,537 $4,989 $5,736 $6,485 Cambridge 02142 $3,486 $3,749 $4,452 $5,387 $5,933 $6,822 $7,713 Canton 02021 $2,499 $2,688 $3,192 $3,864 $4,253 $4,890 $5,529 Carlisle 01741 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Carver 02330 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Chelmsford 01824 $1,922 $2,080 $2,594 $3,141 $3,456 $3,973 $4,492 Chelsea 02150 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Chestnut Hill 02467 $3,108 $3,339 $3,969 $4,799 $5,282 $6,074 $6,866 Cohasset 02025 $2,334 $2,508 $2,982 $3,606 $3,972 $4,567 $5,163 Concord 01742 $2,867 $3,077 $3,665 $4,432 $4,884 $5,616 $6,349 Danvers 01923 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Dartmouth 02745 $976 $1,145 $1,390 $1,681 $1,947 $2,239 $2,531 Dartmouth 02747 $1,046 $1,138 $1,400 $1,688 $2,019 $2,322 $2,625 Dartmouth 02748 $1,028 $1,119 $1,376 $1,659 $1,985 $2,282 $2,580 Dedham 02026 $2,392 $2,570 $3,056 $3,695 $4,070 $4,680 $5,291 Dighton 02715 $1,308 $1,469 $1,929 $2,436 $2,607 $2,997 $3,388 Dover 02030 $3,058 $3,293 $3,910 $4,731 $5,210 $5,991 $6,773 Dracut 01826 $1,400 $1,560 $2,050 $2,470 $2,718 $3,125 $3,533 Duxbury 02332 $2,375 $2,552 $3,035 $3,670 $4,043 $4,648 $5,255 East Bridgewater 02333 $1,688 $1,735 $2,263 $2,867 $3,101 $3,566 $4,031 East Walpole 02032 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 East Wareham 02538 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 East Weymouth 02189 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Easton 02334 $1,730 $1,741 $2,283 $2,751 $3,334 $3,834 $4,334 Easton 02356 $1,985 $1,999 $2,625 $3,175 $3,850 $4,408 $4,983 Essex 01929 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Everett 02149 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Fairhaven 02719 $1,136 $1,237 $1,521 $1,833 $2,194 $2,523 $2,851 Fall River 02720 $1,226 $1,329 $1,609 $1,946 $2,411 $2,772 $3,133 Fall River 02721 $1,226 $1,329 $1,609 $1,946 $2,411 $2,772 $3,133 Fall River 02723 $1,226 $1,329 $1,609 $1,946 $2,411 $2,772 $3,133 Fall River 02724 $1,226 $1,329 $1,609 $1,946 $2,411 $2,772 $3,133 Foxboro 02035 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Framingham 01701 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Framingham 01702 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Franklin 02038 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Freetown 02779 $1,418 $1,617 $2,058 $2,552 $2,846 $3,272 $3,700 Georgetown 01833 $2,093 $2,240 $2,825 $3,401 $3,746 $4,308 $4,870 Gloucester 01930 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Groveland 01834 $1,414 $1,574 $2,062 $2,485 $2,735 $3,144 $3,554 Halifax 02338 $2,101 $2,248 $2,678 $3,361 $3,645 $4,191 $4,738 Hanover 02339 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Hanson 02341 $1,461 $1,561 $2,050 $2,600 $2,913 $3,350 $3,787 Harvard 01451 $2,101 $2,248 $2,678 $3,235 $3,561 $4,094 $4,629 Haverhill 01830 $1,235 $1,410 $1,822 $2,214 $2,427 $2,790 $3,154 Haverhill 01832 $1,235 $1,410 $1,822 $2,214 $2,427 $2,790 $3,154 Haverhill 01835 $1,235 $1,410 $1,822 $2,214 $2,427 $2,790 $3,154 Hingham 02043 $2,605 $2,750 $3,260 $3,930 $4,350 $4,974 $5,623 Holbrook 02343 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Holliston 01746 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Hopkinton 01748 $2,521 $2,710 $3,224 $3,897 $4,296 $4,939 $5,584 Hudson 01749 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Hull 02045 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Ipswich 01938 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Kingston 02364 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Lakeville 02347 $1,747 $1,796 $2,342 $2,967 $3,210 $3,690 $4,172 Lawrence 01840 $1,235 $1,410 $1,822 $2,214 $2,427 $2,790 $3,154 Lawrence 01841 $1,235 $1,410 $1,822 $2,214 $2,427 $2,790 $3,154 Lawrence 01843 $1,235 $1,410 $1,822 $2,214 $2,427 $2,790 $3,154 Lexington 02420 $2,972 $3,192 $3,801 $4,599 $5,061 $5,821 $6,580 Lexington 02421 $3,486 $3,749 $4,452 $5,387 $5,933 $6,822 $7,713 Lincoln 01773 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Littleton 01460 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Lowell 01850 $1,400 $1,560 $2,050 $2,470 $2,718 $3,125 $3,533 Lowell 01851 $1,400 $1,560 $2,050 $2,470 $2,718 $3,125 $3,533 Lowell 01852 $1,400 $1,560 $2,050 $2,470 $2,718 $3,125 $3,533 Lowell 01854 $1,400 $1,560 $2,050 $2,470 $2,718 $3,125 $3,533 Lynn 01901 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Lynn 01902 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Lynn 01904 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Lynn 01905 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Lynnfield 01940 $2,510 $2,699 $3,213 $3,885 $4,284 $4,927 $5,570 Malden 02148 $2,326 $2,499 $2,972 $3,594 $3,959 $4,552 $5,146 Manchester 01944 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Mansfield 02048 $1,922 $2,079 $2,499 $3,035 $3,350 $3,852 $4,355 Marblehead 01945 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Marion 02738 $1,922 $2,079 $2,499 $3,035 $3,350 $3,852 $4,355 Marlborough 01752 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Marshfield 02050 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Mattapoisett 02739 $1,586 $1,691 $2,226 $2,825 $3,161 $3,635 $4,109 Maynard 01754 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Medfield 02052 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Medford 02155 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Medway 02053 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Melrose 02176 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Mendon 01756 $2,101 $2,248 $2,678 $3,550 $4,065 $4,674 $5,284 Merrimac 01860 $1,440 $1,603 $2,100 $2,531 $2,785 $3,202 $3,620 Methuen 01844 $1,235 $1,424 $1,865 $2,247 $2,474 $2,844 $3,215 Middleboro 02346 $1,497 $1,599 $2,100 $2,663 $2,985 $3,431 $3,879 Middleton 01949 $2,413 $2,553 $3,025 $3,645 $4,011 $4,612 $5,213 Milford 01757 $1,300 $1,450 $1,900 $2,663 $3,052 $3,509 $3,967 Millis 02054 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Milton 02186 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Nahant 01908 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Natick 01760 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Needham 02492 $2,375 $2,552 $3,035 $3,670 $4,043 $4,648 $5,255 Needham Hills 02494 $2,367 $2,543 $3,024 $3,657 $4,028 $4,631 $5,236 New Bedford 02740 $976 $1,145 $1,390 $1,681 $1,947 $2,239 $2,531 New Bedford 02744 $976 $1,145 $1,390 $1,681 $1,947 $2,239 $2,531 New Bedford 02745 $976 $1,145 $1,390 $1,681 $1,947 $2,239 $2,531 New Bedford 02746 $976 $1,145 $1,390 $1,681 $1,947 $2,239 $2,531 Newbury 01951 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Newburyport 01950 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Newton 02458 $2,489 $2,678 $3,182 $3,844 $4,243 $4,880 $5,516 Newton - Auburndale 02466 $2,783 $2,993 $3,560 $4,306 $4,737 $5,447 $6,158 Newton - Lower Falls 02462 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Newton - Newtonville 02460 $2,625 $2,825 $3,360 $4,064 $4,473 $5,144 $5,815 Newton - Upper Falls 02464 $2,888 $3,108 $3,696 $4,473 $4,925 $5,663 $6,402 Newton - Waban 02468 $3,140 $3,381 $4,011 $4,851 $5,345 $6,146 $6,948 Newton - West Newton 02465 $2,625 $2,825 $3,360 $4,064 $4,400 $5,127 $5,796 Newton Center 02459 $2,961 $3,182 $3,780 $4,568 $5,030 $5,784 $6,539 Newton Highlands 02461 $3,476 $3,739 $4,442 $5,367 $5,913 $6,799 $7,686 Norfolk 02056 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 North Andover 01845 $1,922 $2,100 $2,709 $3,287 $3,612 $4,154 $4,696 North Attleboro 02760 $1,922 $2,079 $2,499 $3,035 $3,350 $3,852 $4,355 North Billerica 01862 $1,400 $1,560 $2,050 $2,470 $2,718 $3,125 $3,533 North Easton 02356 $1,985 $1,999 $2,625 $3,175 $3,850 $4,408 $4,983 North Easton 02357 $1,730 $1,741 $2,283 $2,751 $3,334 $3,834 $4,334 North Reading 01864 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 North Weymouth 02191 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Norton 02766 $1,870 $2,101 $2,762 $3,487 $3,729 $4,287 $4,847 Norwell 02061 $2,468 $2,646 $3,150 $3,812 $4,200 $4,830 $5,460 Norwood 02062 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Onset 02558 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Peabody 01960 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Pembroke 02359 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Plainville 02762 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Plymouth 02360 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Plympton 02367 $2,101 $2,248 $2,678 $3,235 $3,561 $4,094 $4,629 Quincy 02169 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Quincy 02170 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Quincy 02171 $2,334 $2,508 $2,982 $3,606 $3,972 $4,567 $5,163 Randolph 02368 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Raynham 02767 $1,985 $1,999 $2,625 $3,175 $3,850 $4,408 $4,983 Reading 01867 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Rehoboth 02769 $1,300 $1,391 $1,701 $2,050 $2,487 $2,859 $3,232 Revere 02151 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Rochester 02770 $1,688 $1,735 $2,263 $2,867 $3,101 $3,566 $4,031 Rockland 02370 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Rockport 01966 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Rowley 01969 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Salem 01970 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Salisbury 01952 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Saugus 01906 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Scituate 02066 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Seekonk 02771 $1,712 $1,828 $2,237 $2,700 $3,267 $3,756 $4,247 Sharon 02067 $2,531 $2,720 $3,234 $3,906 $4,305 $4,951 $5,597 Sherborn 01770 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Somerset 02725 $1,295 $1,386 $1,695 $2,043 $2,478 $2,849 $3,220 Somerset 02726 $1,407 $1,512 $1,848 $2,226 $2,699 $3,103 $3,509 Somerville 02143 $2,626 $2,815 $3,350 $4,054 $4,464 $5,133 $5,803 Somerville 02144 $2,856 $3,077 $3,654 $4,421 $4,862 $5,591 $6,320 Somerville 02145 $2,594 $2,793 $3,318 $4,011 $4,421 $5,084 $5,747 South Easton 02375 $2,079 $2,090 $2,751 $3,329 $4,127 $4,745 $5,365 South Weymouth 02190 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Southborough 01772 $2,087 $2,197 $2,678 $3,300 $3,651 $4,199 $4,747 Stoneham 02180 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Stoughton 02072 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Stow 01775 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Sudbury 01776 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Swampscott 01907 $2,615 $2,804 $3,339 $4,032 $4,452 $5,120 $5,788 Swansea 02777 $1,360 $1,481 $1,817 $2,196 $2,658 $3,056 $3,455 Taunton 02780 $1,184 $1,329 $1,746 $2,205 $2,360 $2,713 $3,067 Tewksbury 01876 $2,142 $2,384 $3,129 $3,780 $4,169 $4,794 $5,420 Topsfield 01983 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 Tyngsboro 01854 $1,400 $1,560 $2,050 $2,470 $2,718 $3,125 $3,533 Tyngsboro 01879 $1,400 $1,560 $2,050 $2,470 $2,718 $3,125 $3,533 Wakefield 01880 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Walpole 02081 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Waltham 02451 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Waltham 02452 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Waltham 02453 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Wareham 02571 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Watertown 02472 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Wayland 01778 $2,650 $2,820 $3,350 $4,031 $4,420 $5,103 $5,769 Wellesley 02482 $3,003 $3,234 $3,843 $4,652 $5,114 $5,880 $6,648 Wellesley Hills 02481 $3,486 $3,700 $4,380 $5,281 $5,800 $6,678 $7,550 Wenham 01984 $2,369 $2,506 $2,969 $3,578 $3,936 $4,527 $5,117 West Bridgewater 02379 $1,649 $1,754 $2,310 $2,930 $3,240 $3,640 $4,115 West Newbury 01985 $1,869 $2,132 $2,751 $3,339 $3,665 $4,214 $4,764 Westford 01886 $2,153 $2,395 $3,140 $3,802 $4,180 $4,807 $5,434 Weston 02493 $2,548 $2,734 $3,250 $3,931 $4,300 $4,950 $5,596 Westport 02790 $1,172 $1,254 $1,534 $1,849 $2,243 $2,578 $2,915 Westwood 02090 $2,479 $2,657 $3,161 $3,823 $4,212 $4,843 $5,475 Weymouth 02188 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Whitman 02382 $1,450 $1,520 $1,980 $2,509 $2,714 $3,120 $3,527 Wilmington 01887 $2,783 $2,993 $3,560 $4,306 $4,737 $5,447 $6,158 Winchester 01890 $2,605 $2,804 $3,329 $4,023 $4,432 $5,097 $5,762 Winthrop 02152 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140 Woburn 01801 $2,102 $2,259 $2,686 $3,248 $3,578 $4,114 $4,650 Wrentham 02093 $2,324 $2,497 $2,969 $3,590 $3,955 $4,547 $5,140`;

// Parse the rental data
const parseRentalData = (dataString) => {
  const lines = dataString.split(/(?<=[0-9])\s+(?=[A-Z])/);
  const rentalData = {};
  const townNames = {};

  lines.forEach(line => {
    const parts = line.trim().split(/\s+/);
    if (parts.length >= 9) {
      // Extract town name (may contain spaces and hyphens)
      let townName = '';
      let zipIndex = -1;
      
      for (let i = 0; i < parts.length; i++) {
        if (/^\d{5}$/.test(parts[i])) {
          zipIndex = i;
          break;
        }
        townName += (townName ? ' ' : '') + parts[i];
      }

      if (zipIndex !== -1) {
        const zipCode = parts[zipIndex];
        const rents = {
          "0": parseInt(parts[zipIndex + 1].replace(/[$,]/g, '')),
          "1": parseInt(parts[zipIndex + 2].replace(/[$,]/g, '')),
          "2": parseInt(parts[zipIndex + 3].replace(/[$,]/g, '')),
          "3": parseInt(parts[zipIndex + 4].replace(/[$,]/g, '')),
          "4": parseInt(parts[zipIndex + 5].replace(/[$,]/g, '')),
          "5": parseInt(parts[zipIndex + 6].replace(/[$,]/g, '')),
          "6": parseInt(parts[zipIndex + 7].replace(/[$,]/g, ''))
        };

        rentalData[zipCode] = rents;
        townNames[zipCode] = townName;
      }
    }
  });

  return { rentalData, townNames };
};

// Parse the data
const { rentalData, townNames } = parseRentalData(rentalDataString);

console.log(`Parsed ${Object.keys(rentalData).length} ZIP codes with rental data`);

// Read the current BHA comprehensive data
const bhaFilePath = path.join(__dirname, '..', 'data', 'bha-rents-comprehensive.json');
const bhaData = JSON.parse(fs.readFileSync(bhaFilePath, 'utf8'));

// Update all entries with correct data
let updatedCount = 0;
bhaData.rents.forEach(entry => {
  const zipCode = entry.zip;
  if (rentalData[zipCode]) {
    entry.rents = rentalData[zipCode];
    entry.town = townNames[zipCode] || entry.town;
    updatedCount++;
    console.log(`Updated ${zipCode} (${townNames[zipCode]}) with correct rental rates`);
  }
});

// Update metadata
bhaData.metadata.lastUpdated = new Date().toISOString();
bhaData.metadata.note = "Updated all ZIP codes with correct rental rates and town names from official BHA seed data";

// Write the updated data back to the file
fs.writeFileSync(bhaFilePath, JSON.stringify(bhaData, null, 2));

console.log(`\nUpdated ${updatedCount} ZIP codes with correct rental rates and town names`);
console.log(`BHA data file updated: ${bhaFilePath}`);
